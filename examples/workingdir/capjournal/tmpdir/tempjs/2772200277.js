window.__tnt||(window.__tnt={}),window.__tnt.subscription||(__tnt.subscription={}),window.__tnt.subscription.d||(__tnt.subscription.d=[]),window.__tnt.subscription.access.manifest||(window.__tnt.subscription.access.manifest={denied:{promise:null,resolve:function(){}},granted:{promise:null,resolve:function(){}}}),window.tntPurchase=document.createEvent("Event"),tntPurchase.initEvent("tnt-purchase",!0,!0,{}),window.tntSignup=document.createEvent("Event"),tntSignup.initEvent("tnt-signup",!0,!0,{}),window.__tnt.subscription.d.push(function(e){var t=0,s=(document.getElementById("access-wall-subscription"),[]),a=document.getElementById("asset-content"),r=[],c=1,n=!1,o=document.getElementById("access-offers-modal"),l=o.querySelector(".modal-content.active"),d=document.getElementById("modal-offers-tab"),u=d.querySelector("template.template-promo-service"),m=document.getElementById("access-modal-description"),p=d.querySelector(".output"),g=document.getElementById("user-modal-tab-purchase"),f=(document.getElementById("form-super-purchase"),document.getElementById("user-purchase-rate")),v=document.head.querySelector('meta[property="og:site_name"]'),h="",_=!1,y=!1,b=document.getElementById("user-modal-tab-login"),L=document.getElementById("user-modal-tab-signup");if(o.hasAttribute("data-preview")&&(n=!0),v&&(h=v.content),Array.isArray(e.offer_config)){if(e&&e.access_methods&&e.access_methods.length)for(i=0;i<e.access_methods.length;i++){var S=e.access_methods[i];"subscription"==e.access_methods[i].type&&t++,S&&S.metadata&&s.push(S.metadata.service_id),S&&S.type&&"user"==S.type?_=!0:y=!0}var w=document.getElementById("access-offers-modal");if(a&&w&&(a.querySelectorAll(".subscriber-hide,.subscriber-remove,.subscriber-only"),w.classList.remove("access-offers-wrapper"),w.classList.remove("access-offers-modal"),w.classList.add("access-methods-modal")),w){d.querySelector(".offer-group-title"),document.getElementById("access-modal-description");t<=2&&w.classList.add("modal-small"),null!=e.access_rule.message?(m.innerHTML=e.access_rule.message.description,m.classList.add("padding-bottom"),d.querySelector(".offer-group-title").innerHTML=e.access_rule.message.title):(m.innerHTML="",m.classList.remove("padding-bottom"));var o=document.getElementById("access-offers-modal"),q=null,E=null,v=document.head.querySelector('meta[property="og:site_name"]'),h="",r=[],c=1,n=!1;if(o&&(q=document.getElementById("access-methods")),q&&(E=document.getElementById("access-methods")),v&&(h=v.content),o.hasAttribute("data-preview")&&(n=!0),e.access_methods&&e.access_methods.length&&q){q.innerHTML="";for(var k=0;k<e.access_methods.length;k++){var S=e.access_methods[k];if(sType=S.type,"customjavascript"==sType&&S.response.type?sType=S.response.type:"customjavascript"==sType&&(sType="custom_javascript"),"function"==typeof __tnt.subscription.access.output[sType]){var I=o.querySelector("template.template-promo-service"),A=E,T=__tnt.subscription.access.output[sType](S),B=[];T.elements&&(B=T.elements),T.callback,T.callback,A&&A.getAttribute("data-referer"),__tnt.template(I,A,!1,B,function(e){e.querySelector(".method-featured").remove(),e.querySelector(".method-link").addEventListener("click",function(e){e.preventDefault();var t,s,a,r=(e.target,document.head.querySelector('meta[property="og:site_name"]')),c="",i=e.target,o=0;document.getElementById("access-offers-modal");for(r&&(c=r.content);"A"!=i.tagName&&o<3;)"A"!=i.tagName&&(i=i.parentNode),o++;if(i&&(t=i.dataset.subscriptionService,s=i.dataset.name,a=i.href),window.sessionStorage)try{sessionStorage.setItem("__tnt.service.list","Article")}catch(e){}n?document.location=a:dataLayer.push({ecommerce:{click:{actionField:{list:"Article"},products:[{name:s,id:t,price:"",brand:c,category:"subscription",quantity:1}]}},event:"tncms.event.trigger",tncms:{event:{trigger:{action:"productClick",category:"subscription",label:"user clicked on a service"}}},eventCallback:function(){setTimeout(function(){document.location=a},100)}})});var t=S.id;S.metadata.service_id&&(t=S.metadata.service_id),r.push({id:t,name:S.name,price:"",brand:h,category:"Subscription",list:"Article",position:c}),c++})}}}}}else e.offer_config.offers&&(p.innerHTML="",e.offer_config.message&&m?(m.innerHTML=e.offer_config.message,m.classList.add("padding-bottom")):(m.innerHTML="",m.classList.remove("padding-bottom")),d.querySelector(".offer-group-title").innerHTML=e.offer_config.title,e.offer_config.offers.length<=2?o.classList.add("modal-small"):o.classList.remove("modal-small"),e.offer_config.offers.forEach(function(e){var t=e.description,s="Get Started",a=null;e.button_text&&(s=e.button_text),e.image&&(a='<figure class="photo layout-horizontal padding-bottom"><div class="image"><img class="img-responsive full default" src="'+e.image+'" alt="'+e.title+'"/></div></figure>');var i=[{element:".subscription-service.panel",attr:[{attr:"class",value:"promotion-service subscription-service panel panel-default"},{attr:"data-offer-id",value:e.id}]},{element:".method-header",html:e.title},{element:".method-image",html:a},{element:".offer-rate",html:e.rate},{element:".offer-limits",html:e.limits},{element:".offer-cycle",html:e.billing_cycle},{element:".offer-savings",html:e.savings},{element:".offer-cancel",html:"Cancel anytime"},{element:".method-description",html:t}];null!=e.service_id&&null!=e.rate_id?i.push({element:"a.method-link",html:s,attr:[{attr:"class",value:"method-link btn btn-danger btn-lg"},{attr:"data-subscription-service",value:e.service_id},{attr:"data-subscription-rate",value:e.rate_id},{attr:"data-subscription-rate-name",value:e.rate},{attr:"data-name",value:e.title}]}):e.link_js?i.push({element:"a.method-link",html:s,attr:[{attr:"class",value:"method-link btn btn-danger btn-lg"},{attr:"href",value:"javascript:void(0)"},{attr:"onClick",value:e.link_js},{attr:"data-name",value:e.title}]}):i.push({element:"a.method-link",html:s,attr:[{attr:"class",value:"method-link btn btn-danger btn-lg"},{attr:"href",value:e.link_url},{attr:"data-name",value:e.title}]}),e.featured_message&&i.push({element:".method-featured",html:'<span class="featured-icon"></span><span class="featured-message">'+e.featured_message+"</span>",attr:[{attr:"class",value:"method-featured featured-"+e.featured}]}),__tnt.template(u,p,!1,i,function(t){t.querySelector("a.method-link").addEventListener("click",function(t){if(t.preventDefault(),t.target.getAttribute("data-subscription-service")){var s=t.target.getAttribute("data-subscription-service"),a=t.target.getAttribute("data-name"),r=t.target.getAttribute("data-subscription-rate");fetch("/tncms/subscription/services/?service_id="+s,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(function(c){c.ok&&c.json().then(function(c){var i=document.getElementById("form-super-purchase"),n=null,l=0,d=(t.target.getAttribute("data-subscription-rate-name"),"days");if(i.elements.service_id.value=s,i.elements.rate_id.value=r,Array.isArray(c[0].rates))for(;!n&&l<c[0].rates.length&&l<5;)c[0].rates[l].id==r&&(n=c[0].rates[l]),l++;n&&(n.duration>7&&(i.querySelector(".service-renews").hidden=!1),1==n.duration&&(d="day"),n.price,n.duration);var u=f.querySelector("template"),m=f.querySelector(".output"),p=[{element:".rate-name",html:e.title},{element:".rate-price",html:e.rate},{element:".service-description",html:e.description},{element:"a.service-link",attr:[{attr:"href",value:e.link_url}]}];m.innerHTML="",__tnt.template(u,m,!1,p,function(e){e.querySelector(".rate-info").addEventListener("click",function(e){var t=document.getElementById("user-purchase-rate"),s=document.getElementById("user-purchase-rate").querySelector(".service-rate .rate-info-expander");t.classList.toggle("expanded"),t.querySelector(".service-rate .service-details").classList.toggle("hide"),s.querySelector(".collapsed").classList.toggle("hide"),s.querySelector(".expanded").classList.toggle("hide")});var t=g.querySelector(".delivery-location-required"),r=!1;c[0].delivery_required&&(r=!0),t&&r?t.hidden=!1:t&&(t.hidden=!0),i.dispatchEvent(tntPurchase),__tnt.subscription.access.showTab(g,o.id,"access-methods"),dataLayer.push({ecommerce:{detail:{actionField:{list:"Article"},products:[{name:a,id:s,price:"",brand:h,category:"subscription",variant:""}]}},event:"tncms.event.trigger",tncms:{event:{trigger:{action:"productDetailViewed",category:"subscription",label:"loaded service purchase page"}}},eventCallback:function(){}}),__tnt.subscription.handleCart(n,s,a,h)})})}),n||dataLayer.push({ecommerce:{click:{actionField:{list:"Article"},products:[{name:a,id:s,price:"",brand:h,category:"subscription",quantity:1}]}},event:"tncms.event.trigger",tncms:{event:{trigger:{action:"productClick",category:"subscription",label:"user clicked on a service"}}},eventCallback:function(){}})}else"javascript:void(0)"!=t.target.href&&(document.location=t.target.href)});var s=e.id;e.service_id&&(s=e.service_id),r.push({id:s,name:e.title,price:"",brand:h,category:"Subscription",list:"Article",position:c}),c++})}));if(l&&d)if(l.classList.add("hide"),l.classList.remove("active"),_&&!y&&b&&L){var H=L.querySelector("form");w.classList.add("access-offers-wrapper"),w.classList.add("access-offers-modal"),w.classList.remove("access-methods-modal"),L.classList.remove("hide"),L.classList.add("active"),H&&H.dispatchEvent(tntSignup);try{b.querySelector(".tab-back").remove(),L.querySelector(".tab-back").remove()}catch(e){}var M=L.querySelector(".modal-header h3");if(e.access_rule.message&&e.access_rule.message.title)try{if(e.access_rule.message.description){var C=document.createElement("p");C.innerHTML=e.access_rule.message.description,C.classList.add("text-center"),L.querySelector(".modal-header").appendChild(C),M.classList.add("padding-bottom")}M.innerHTML=e.access_rule.message.title}catch(e){}}else __tnt.subscription.access.showTab(d,"access-offers-modal","access-methods");else d&&__tnt.subscription.access.showTab(d,"access-offers-modal","access-methods");$(o).find(".modal").modal("show"),r.length&&!n&&dataLayer.push({ecommerce:{impressions:r},event:"tncms.event.trigger",tncms:{event:{trigger:{action:"productImpressionsFinished",category:"subscription",label:"services displayed to user"}}}})}),window.__tnt.subscription.d.push(function(e){var t=null;if(e.access_rule){__tnt.trackEvent({category:"subscription",action:"wall",label:e.access_rule.name,value:0});try{window.localStorage&&(t=window.localStorage.getItem("tnt:access:rule"),e.access_rule.id!=t&&(localStorage.setItem("tnt:access:rule",e.access_rule.id),localStorage.setItem("tnt:access:rule:name",e.access_rule.name),__tnt.trackEvent({category:"Access Control",action:"Access Rule Change",label:e.access_rule.name,value:""})))}catch(e){}}}),__tnt.subscription.access.manifest.denied.resolve();
//# sourceMappingURL=tnt.access.denied.4.0.offers.c9185946402bd860f0e8bed555834541.js.map