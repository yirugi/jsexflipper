var __tnt=window.__tnt||{};googletag=window.googletag||{},gptAdSlots=window.gptAdSlots||[],__tnt.ads=window.__tnt.ads||{},__tnt.ads.slots=__tnt.ads.slots||{},googletag.cmd=window.googletag.cmd||[],__tnt.ads.refreshPos=function(e,t){if(-1==location.href.indexOf("tncms/admin"))try{var i=!1;if(e&&(e=e.split(",")),"undefined"!=typeof gptAdSlots){if(e){i=!0;var n=null;n=[];for(var a=0;a<e.length;a++)n.push(gptAdSlots[e[a]])}t&&t.destroy?googletag.cmd.push(function(){googletag.pubads().clear(n)}):googletag.cmd.push(function(){googletag.pubads().clear(n),googletag.pubads().refresh(n)})}if(t&&!t.destroy&&!i&&void 0!==TNCMS.AdManager)for(var a=0;a<e.length;a++)TNCMS.AdManager.refresh({region:e[a]})}catch(e){console.log(e)}},function(e,t,i,n,a){var r,d,s,o,l,f,c,g,h,u=function(){var i={};return i.characterCount=function(t){var i=u.getMeta("tncms:ad_instory");return i&&(i=i.split(",")),1==t?i[0]||580:e.innerWidth<768?i[1]||776:e.innerWidth<992?i[2]||1164:i[3]||1552},i.debugMode=function(){return!!/[?&]ads_log/.test(e.location.search)},i.filterSizes=function(t,i,n){var a=i.offsetWidth,l=!1;return(o||s||d||r)&&(l=!0,t=e.innerWidth<768&&o?o:e.innerWidth<992&&s?s:e.innerWidth<1200&&d?d:r||[]),"/132916964/cen"===n&&(t=t.filter(function(e){return 2!==e[0]||1!==e[1]})),!l&&e.innerWidth>=768&&(t=t.filter(function(e){return!(320===e[0]&&50===e[1]||300===e[0]&&50===e[1])})),t=t.filter(function(e){return e[0]<=a}),!l&&t.length<3&&(t=e.innerWidth<768?[[300,250],[320,50],[300,50],[2,1]]:[[300,250],[2,1]]),t},i.getMeta=function(e){var i=t.head.querySelector('meta[property="'+e+'"]');return!!i&&i.content},i.hasPrebid=function(t){var i=!1;if(void 0!==e.adUnits)for(var n in e.adUnits)if(e.adUnits.hasOwnProperty(n)&&e.adUnits[n].code==t)return i=!0,!1;return i},i.inViewport=function(i){if(t.getElementById(i)){var n=t.getElementById(i).getBoundingClientRect();return Math.round(n.top)>=0&&Math.round(n.left)>=0&&Math.round(n.bottom)<=(e.innerHeight||t.documentElement.clientHeight)&&Math.round(n.right)<=(e.innerWidth||t.documentElement.clientWidth)}},i.limitRefreshSizes=function(e,i){var n=t.getElementById(e).querySelector("iframe");if(n)for(var a=[],r=0;r<i.length;r++)if((2!==i[r][0]||1!==i[r][1])&&i[r][0]===n.offsetWidth&&i[r][1]===n.offsetHeight)return a.push(i[r]),a;return!1},i.log=function(t){e.console&&e.console.log(t)},i}(),m={_init:function(){try{c=u.getMeta("tncms:ads").split(","),g=u.getMeta("tncms:ad_refresh_interval")?parseInt(u.getMeta("tncms:ad_refresh_interval")):2e4,r=u.getMeta("tncms:ad_instory_sizes_lg")?JSON.parse(u.getMeta("tncms:ad_instory_sizes_lg")):null,d=u.getMeta("tncms:ad_instory_sizes_md")?JSON.parse(u.getMeta("tncms:ad_instory_sizes_md")):null,s=u.getMeta("tncms:ad_instory_sizes_sm")?JSON.parse(u.getMeta("tncms:ad_instory_sizes_sm")):null,o=u.getMeta("tncms:ad_instory_sizes_xs")?JSON.parse(u.getMeta("tncms:ad_instory_sizes_xs")):null;var e=-1!=c.indexOf("dmp"),t=-1!=c.indexOf("lazyload"),i=-1!=c.indexOf("refresh"),n=-1!=c.indexOf("refresh_timer"),a=-1!=c.indexOf("smart");(t||i||n||a)&&(a&&m.initAdInjection(),(t||i||n)&&m.getEligibleSlots(),e&&m.progTargeting(),m.observeAds())}catch(e){return _&&u.log(e),!1}},_initHandler:function(e){"tnt-dmp-audience-extracted"===e.type?(h=e.detail.userAudience,A&&!w||m._init()):"tnt-user-status"===e.type&&(w=!0,y&&void 0===h||m._init())},createAdTag:function(e){var i=t.createElement("div"),n=t.createElement("div"),a=t.createDocumentFragment();return i.id=e,i.className="tnt-ads dfp-smart-ad",n.className="tnt-ads-container text-center",a.appendChild(n),a.querySelector(".tnt-ads-container").appendChild(i),a},defineGAMSlot:function(e,t,i,r){n.cmd.push(function(){var d=n.sizeMapping().addSize([0,0],i).build();a[t]=n.defineSlot(e,[2,1],t).defineSizeMapping(d).setCollapseEmptyDiv(!0).addService(n.pubads()),a[t].setTargeting("pos",r)})},destroySlot:function(e){n.cmd.push(function(){n.destroySlots([a[e]])})},fetchAds:function(e){for(var t=[],i=[],r=0;r<e.length;r++)"blox"===e[r].vendor?t.push(e[r]):"gam"===e[r].vendor&&i.push(e[r]);if(t.length>0)for(var r=0;r<t.length;r++)TNCMS.AdManager.refresh({region:t[r].region});if(i.length>0){for(var d=[],s=[],o=[],r=0;r<i.length;r++)u.hasPrebid(i[r].id)&&(i[r].initLoad||i[r].biddingRefresh)?o.push(i[r].id):"undefined"!=typeof apstag&&(i[r].initLoad||i[r].biddingRefresh)?d.push(i[r].id):s.push(i[r].id),i[r].initLoad&&(i[r].initLoad=!1),i[r].viewableImpression&&(i[r].viewableImpression=!1);d.length>0&&n.cmd.push(function(){for(var e=[],t=0;t<d.length;t++)e.push(a[d[t]]);apstag.fetchBids({slots:e,timeout:2e3},function(t){apstag.setDisplayBids(),n.pubads().refresh(e)})}),s.length>0&&n.cmd.push(function(){for(var e=[],t=0;t<s.length;t++)e.push(a[s[t]]);n.pubads().refresh(e)}),o.length>0&&pbjs_refreshBid(o)}},getEligibleSlots:function(){for(var e=t.querySelectorAll(".dfp-ad, .blox-ad, [data-tnt-ads-tmp]"),n=0;n<e.length;n++)if("fixed-big-ad-gallery"!=e[n].id&&"fixed-big-ad-paging-gallery"!=e[n].id)if("none"==e[n].style.display&&e[n].classList.contains("dfp-ad")||"none"==e[n].style.display&&e[n].classList.contains("blox-ad"))e[n].remove();else{var a=e[n].classList.contains("dfp-ad")?"gam":"blox",r=m.verifySlot(e[n],a);r&&(_&&u.log(r),i[r.id]=r)}},initAdInjection:function(){if(void 0!==__tnt.ads.dfp.dmp&&void 0!==__tnt.ads.dfp.dmp.hideAudience&&"object"==typeof h&&h.length>0){for(var e=0;e<h.length;e++)h[e]=h[e].replace("keyword:","");if(__tnt.compareArray(h,__tnt.ads.dfp.dmp.hideAudience))return!1}var i=t.getElementById("asset-content"),n=i.querySelector(".asset-content"),a=n.childNodes;v=i.dataset.smartAdunit,a.length>0&&(b=u.filterSizes(p,n,v),m.insertAds(a))},insertAds:function(e){for(var t=1,n=0,a=0;a<e.length;a++)if("P"==e[a].tagName||"DIV"==e[a].tagName&&e[a].classList.contains("subscriber-preview")||"DIV"==e[a].tagName&&e[a].classList.contains("subscriber-only")){if("DIV"==e[a].tagName&&"P"!=e[a].firstChild.tagName)continue;var r="DIV"==e[a].tagName?e[a].firstChild:e[a],d=r.innerHTML.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim().length;if(n+=d,_){var s={"Paragraph Count":a,"Paragraph Length":d,"Character Count":n,"Character Count Minimum":u.characterCount(t)};u.log(s)}if(n>=u.characterCount(t)){var o="tnt-smart-ad-"+t,l={alwaysLoad:!1,id:o,initLoad:!1,count:t,lazyload:!0,refresh:!0,timestamp:null,type:"injected",vendor:"gam",viewableImpression:!1};1===t&&(l.delayRefresh=!0),r.parentNode.insertBefore(m.createAdTag(o,t),r.nextSibling),_&&u.log("Ad was inserted after paragraph "+a+". Eligible character count was "+n),m.defineGAMSlot(v,o,b,["fixed_automatic_ad","fixed_automatic_ad"+t]),i[o]=l,t++,n>0&&(n=0)}}},refreshTimer:function(){m.interactionRefresh(),l=setTimeout(m.refreshTimer,5e3)},interactionRefresh:function(){var n=[],a=Date.now(),r=0;for(var d in i)if(i.hasOwnProperty(d)&&u.inViewport(i[d].id)&&null!=i[d].timestamp)if(e.innerWidth>=992&&"injected"===i[d].type){if(i[d].delayRefresh){var s=t.getElementById("asset-photo-carousel");if(s){var o=s.querySelector(".owl-carousel");if(!o)continue;if(!o.classList.contains("owl-loaded"))continue;i[d].delayRefresh=!1,i[d].timestamp=a}else i[d].delayRefresh=!1}if(i[d].timestamp<a-g)if(!0===i[d].viewableImpression){var l=u.limitRefreshSizes(i[d].id,b);l?(t.getElementById(i[d].id).style["min-height"]=l[0][1]+"px",m.destroySlot(i[d].id),m.defineGAMSlot(v,i[d].id,l,["fixed_automatic_ad","fixed_automatic_ad"+i[d].count]),n.push(i[d]),_&&u.log("Ad "+i[d].id+" is visible and has been refreshed.")):_&&u.log("Ad "+i[d].id+" is visible but could not be refreshed. The size of the initally loaded ad could not be determined."),i[d].timestamp=a}else _&&u.log("Ad: "+i[d].id+" cannot be refreshed until the ad is visible.");else _&&(r=Math.round((i[d].timestamp+g-a)/1e3*10)/10,u.log("Ad "+i[d].id+" is visible and has a remaining life of "+r+" seconds."))}else e.innerWidth>=992||e.innerWidth<992&&i[d].mobileRefresh?i[d].timestamp<a-g?"gam"===i[d].vendor&&1==i[d].viewableImpression||"blox"===i[d].vendor?(_&&u.log("Ad: "+i[d].id+" is visible and has been refreshed."),i[d].timestamp=a,n.push(i[d])):_&&u.log("Ad: "+i[d].id+" cannot be refreshed until the ad is visible."):_&&(r=Math.round((i[d].timestamp+g-a)/1e3*10)/10,u.log("Ad: "+i[d].id+" is visible and has a remaining life of "+r+" seconds.")):(_&&u.log("Ad "+i[d].id+" : Ad refresh is disabled in the mobile viewport."),delete i[d]);n.length>0&&m.fetchAds(n)},observeAds:function(){var n=[],a=u.getMeta("tncms:ads_lazyload_margin")?u.getMeta("tncms:ads_lazyload_margin"):"300px",r=new IntersectionObserver(function(e){var t=[];e.forEach(function(e){(i[e.target.id].alwaysLoad||e.intersectionRatio>0)&&((i[e.target.id].alwaysLoad||i[e.target.id].lazyload)&&(_&&i[e.target.id].alwaysLoad&&u.log("Ad "+e.target.id+" has been immediately loaded due to header bidding."),_&&i[e.target.id].lazyload&&u.log("Ad "+e.target.id+" is visible and has been lazyloaded."),i[e.target.id].initLoad=!0,t.push(i[e.target.id])),i[e.target.id].refresh&&(i[e.target.id].timestamp=Date.now()),r.unobserve(e.target))}),t.length>0&&m.fetchAds(t)},{rootMargin:a});for(var d in i)i.hasOwnProperty(d)&&n.push(t.getElementById(i[d].id));n.forEach(function(e){r.observe(e)}),-1!=c.indexOf("refresh_timer")?(m.refreshTimer(),e.addEventListener("scroll",function(){e.clearTimeout(f),e.clearTimeout(l),f=setTimeout(function(){_&&u.log("Reset ad refresh timer."),l=setTimeout(m.refreshTimer,5e3)},66)},{passive:!0})):(e.addEventListener("scroll",m.throttle(m.interactionRefresh,500)),e.addEventListener("focus",m.throttle(m.interactionRefresh,500))),Array.from(t.querySelectorAll(".photo-carousel-control")).forEach(function(e){e.addEventListener("click",m.interactionRefresh)})},progTargeting:function(){if(void 0!==__tnt.ads.dfp.dmp&&"object"==typeof h){for(var e=0;e<h.length;e++)h[e]=h[e].replace("keyword:","");n.cmd.push(function(){n.pubads().setTargeting("las",h)})}},throttle:function(t,i){var n=this,a=Date.now(),r=0;return function(){var d=e.pageYOffset;d>r&&a+i-Date.now()<0&&(t.apply(n),a=Date.now()),r=d}},verifySlot:function(e,t){try{var i={alwaysLoad:!1,id:e.id,initLoad:!1,lazyload:!1,refresh:!1,timestamp:null,type:"inline",vendor:t,viewableImpression:!1};if("gam"===t){if(!e.id)throw["No id on the "+t+"-ad div:",e.outerHTML];if(i.id=e.id,!(e.dataset.lazy||e.dataset.refresh||e.dataset.biddingRefresh||e.dataset.alwaysLoad))throw["Ad has already been loaded and is not refreshable",e.outerHTML];e.dataset.lazy&&(i.lazyload=!0),e.dataset.refresh&&(i.refresh=!0,e.dataset.mobileRefresh&&(i.mobileRefresh=!0)),e.dataset.biddingRefresh&&(i.biddingRefresh=!0),e.dataset.alwaysLoad&&(i.alwaysLoad=!0)}else if("blox"===t){var n;if(!e.dataset.tntAds&&!e.dataset.tntAdsTmp)throw["No settings defined the blox-ad div:",e.outerHTML];if(n=e.dataset.tntAds?JSON.parse(e.dataset.tntAds):JSON.parse(e.dataset.tntAdsTmp),!n.refresh)throw["Ad has already been loaded and is not refreshable",e.outerHTML];i.refresh=!0,i.id="position"==n.type?"blox-ad-position-"+n.region+n.slot:"blox-ad-position-"+n.region+"1",i.region=n.region}return i}catch(e){for(var a=0;a<e.length;a++)_&&u.log(e[a]);return!1}}},p=[[970,250],[970,90],[728,90],[300,250],[320,50],[300,50],[2,1]],v="",y=void 0!==__tnt.ads.dfp&&void 0!==__tnt.ads.dfp.dmp&&(void 0!==__tnt.ads.dfp.dmp.hideAudience||u.getMeta("tncms:ads").split(",").indexOf("dmp")>-1),_=u.debugMode(),b=[],A=!!u.getMeta("tncms:subs"),w=!1;y||A?(y&&e.addEventListener("tnt-dmp-audience-extracted",m._initHandler,!1),A&&e.addEventListener("tnt-user-status",m._initHandler,!1)):e.addEventListener("DOMContentLoaded",m._init,!1)}(window,document,__tnt.ads.slots,googletag,gptAdSlots);
//# sourceMappingURL=tnt.ads.core.fa820af8c4b7651b60faff4dca7ed722.js.map