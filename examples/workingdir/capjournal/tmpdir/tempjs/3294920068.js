window.TNCMS=window.TNCMS||{},window.TNCMS.Access=TNCMS.Access||[],window.__tnt||(window.__tnt={}),window.__tnt.subscription||(__tnt.subscription={}),window.__tnt.subscription.api||(__tnt.subscription.api={}),window.__tnt.subscription.b||(__tnt.subscription.bp=[]),window.__tnt.subscription.b||(__tnt.subscription.ap=[]),window.__tnt.subscription.a||(__tnt.subscription.a=[]),window.__tnt.subscription.d||(__tnt.subscription.d=[]),window.__tnt.subscription.access||(__tnt.subscription.access=[]),window.__tnt.subscription.access.output||(__tnt.subscription.access.output={}),window.__tnt.subscription.access.promises||(window.__tnt.subscription.access.promises=[]),window.__tnt.subscription.access.manifest||(window.__tnt.subscription.access.manifest={denied:{promise:null,resolve:function(){}},granted:{promise:null,resolve:function(){}}}),__tnt.subscription.access.showLoginModal=!1,__tnt.subscription.access.showPurchaseModal=!1,__tnt.subscription.access.checkedAccess=!1,__tnt.user.firstLogin=!1,__tnt.user.loginSuccess=!1,__tnt.user.purchasedAccess=!1,__tnt.subscription.access.manifest.denied.promise=new Promise(function(t,s){__tnt.subscription.access.manifest.denied.resolve=t}),__tnt.subscription.access.manifest.granted.promise=new Promise(function(t,s){__tnt.subscription.access.manifest.granted.resolve=t}),__tnt.subscription.access.promises.push(__tnt.subscription.access.manifest.denied.promise),__tnt.subscription.access.promises.push(__tnt.subscription.access.manifest.granted.promise),window.userStatus=document.createEvent("Event"),userStatus.initEvent("tnt-user-status",!0,!0),userStatus.version=3,userStatus.hasAccess=!1,userStatus.accessMethod="none",userStatus.accessError=null,window.TNCMS.Access.push(function(){TNCMS.Access.checkAccess(function(t){var s=document.getElementById("asset-content"),e=document.getElementById("eedition-wrapper"),n=0,i=0,c=0;if(e&&(s=e),__tnt.subscription.bp.length)for(c=0;c<__tnt.subscription.bp.length;c++)"function"==typeof __tnt.subscription.bp[c]&&__tnt.subscription.bp[c](t);Promise.all(__tnt.subscription.access.promises).then(function(e){var c=0,o=0,r=0;if(e.length){for(o=0;o<e.length;o++)void 0!==e[o]&&void 0!==e[o].has_access&&e[o].has_access&&(t.required=!1);for(r=0;r<__tnt.subscription.ap.length;r++)t=__tnt.subscription.ap[r](t,e);for(c=0;c<t.access_methods.length;c++){var u=t.access_methods[c];void 0!==u.response&&"number"==typeof u.response.promise_position&&(e[u.response.promise_position].has_access&&(t.required=!1),t.access_methods[c].response=e[u.response.promise_position].data)}}if(t.required)for(i=0;i<__tnt.subscription.d.length;i++)__tnt.subscription.d[i](t);else{for(n=0;n<__tnt.subscription.a.length;n++)__tnt.subscription.a[n](t);s&&(s.hidden=!1),userStatus.hasAccess=!0}__tnt.subscription.access.status&&__tnt.subscription.access.status.trigger(userStatus),__tnt.subscription.access.checkedAccess=!0;var a=document.getElementById("service-promo-modal"),_=document.getElementById("access-offers-modal"),d=t.access_rule.wall_behavior;_&&(a=_),a&&$(a.querySelector(".modal")).modal({show:!1}).on("hide.bs.modal",function(){if(__tnt.user.loginSuccess||"nag"==d){if("nag"==d){var s=document.getElementById("asset-content"),e=null,n=null;s&&(e=s.querySelector(".asset-content.subscriber-premium"),n=e.querySelectorAll(".subscriber-preview"),e.querySelector(".encrypted-content")&&n[n.length-1].classList.add("prompt-additional-content"))}}else{var i=__tnt.scrubUrl(t.access_rule.dismiss_url);i||(i=__tnt.scrubUrl("/")),location.pathname!=i&&(document.location.href=i)}}),"nag"==d&&s&&(s.hidden=!1)},function(t){console.log("failed: ",t)})})}),__tnt.subscription.access.endpointUrl=function(){var t=document.getElementById("service-promo-modal"),s="";if(t&&t.getAttribute("data-endpoint")&&(s=__tnt.scrubUrl(t.getAttribute("data-endpoint"))),window.localStorage)try{localStorage.getItem("tnt:access:rule")&&(s+="&accessRule="+localStorage.getItem("tnt:access:rule"))}catch(t){}return s},document.addEventListener("DOMContentLoaded",function(t){if(void 0===userStatus.hasAccess||0==userStatus.hasAccess){var s=document.getElementById("asset-content"),e=(document.createElement("div"),document.getElementById("eedition-wrapper"));e&&(s=e,s.hidden=!0),s&&(s.hidden=!0)}});
//# sourceMappingURL=tnt.access.3.1.f98080aea53841a1aed37f0ee0c16322.js.map