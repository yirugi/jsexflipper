(window._vfP=window._vfP||[]).push([[163],{481:function(t,n,e){"use strict";e.r(n);e(46),e(11),e(8),e(7),e(4),e(22),e(39),e(42),e(41),e(17);var r,u=e(0),i=e(296);function o(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function c(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?o(Object(e),!0).forEach((function(n){a(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function a(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var _,d=(a(r={},u.Sc,(function(t,n,e,r){return function(e){var i=t[e];if(i){var o=r[u.Qb];return c(c({},i),{},{thread_palette:n[u.Uc](e),visible_content:i.visible_content.filter(o),realtime_content:i.realtime_content.filter(o)})}}})),a(r,u.Xc,(function(t,n,e,r){return function(t){var e=n[u.Sc](t);if(e){var i=r[u.db],o=r[u.eb];return c(c({},e),{},{pinned_content:e.visible_content.filter(i),unpinned_content:e.visible_content.filter(o)})}}})),a(r,u.td,(function(t,n,e,r){return function(n){return t[n].visible_content.filter(r[u.Qb])}})),a(r,u.Tc,(function(t){return function(n){var e=t[n],r=e.total_content,u=e.visible_content,i=e.realtime_content;return r-u.length-i.length}})),a(r,u.qd,(function(t,n,e,r){return function(n){return t[n].visible_replies.map(r[u.S])}})),a(r,u.Vc,(function(t){return function(n){return t[n].realtime_content.length}})),a(r,u.Ac,(function(t){return function(n){return t[n].selected_content}})),a(r,u.cc,(function(t){return function(n){var e=n.content_uuid,r=n.thread_uuid;return t[r].unread_reply_content.includes(e)}})),a(r,u.bc,(function(t){return function(n){var e=n.content_uuid,r=n.thread_uuid;return t[r].unread_mention_content.includes(e)}})),a(r,u.Hb,(function(t){return function(n){return Boolean(t[n].unread_reply_content.length)}})),a(r,u.Fb,(function(t){return function(n){return Boolean(t[n].unread_mention_content.length)}})),a(r,u.Gb,(function(t,n,e,r){return function(n){var e=n.thread_uuid,i=n.subthread_uuid;return Boolean(t[e].unread_reply_content.filter((function(t){return r[u.S](t).parent_uuid===i})).length)}})),a(r,u.Eb,(function(t,n,e,r){return function(n){var e=n.thread_uuid,i=n.subthread_uuid;return Boolean(t[e].unread_mention_content.filter((function(t){return r[u.S](t).parent_uuid===i||r[u.ed](t).target_uuid===i})).length)}})),a(r,u.fd,(function(t,n,e,r){return function(n){return t[n].unread_reply_content.map(r[u.S])}})),a(r,u.Ib,(function(t,n,e,r){return function(n){return t[n].unread_reply_content.filter(r[u.Y]).length>0}})),a(r,u.Uc,(function(t){return function(n){var e=t[n],r=e.unread_mention_content,u=e.unread_reply_content;return r.length>0?i.a.MENTION:u.length>0?i.a.ACCENT:i.a.LIGHT_PRIMARY}})),a(r,u.l,(function(t,n,e,r){return function(e){var i=n[u.td](e),o=r[u.xd](e),c=o.promo_interval,a=o.first_promo_position,_=t[e].base_promo_uuid,d=_?i.indexOf(_):i.length-1,l=_?d+a-1:d;return i.filter((function(t,n){return!(n!==l||!_)||(n>l&&(n-l)%c==0||!!(n<d&&(l-n)%c==0))}))}})),a(r,u.ac,(function(t,n){return function(t,e){return n[u.l](t).includes(e)}})),r),l=(e(148),e(31),e(2)),f=e(40),s=e(26);function v(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var h,b=Object(f.b)(s.default,"thread_uuid",(function(t){return{thread_uuid:t,thread_top_uuid:null,visible_content:[],unread_mention_content:[],unread_reply_content:[],realtime_content:[],selected_content:[],base_promo_uuid:null,total_content:0,is_in_view:!1,page_from:null,more_available:!1}})),m=(v(_={},l.R,b),v(_,l.Ub,(function(t,n){s.default.delete(t,n)})),v(_,l.Hb,(function(t,n){var e=n.thread_uuid,r=n.content_uuid;t[e].visible_content=t[e].visible_content.filter((function(t){return t!==r}))})),v(_,l.Gb,(function(t,n){var e=n.thread_uuid,r=n.content_uuid;t[e].realtime_content=t[e].realtime_content.filter((function(t){return t!==r}))})),v(_,l.z,(function(t,n){var e=n.thread_uuid,r=n.content_uuid;t[e].visible_content.includes(r)||t[e].visible_content.push(r)})),v(_,l.vb,(function(t,n){var e=n.thread_uuid,r=n.content_uuid;if(!t[e].visible_content.includes(r)){var u=t[e].visible_content;t[e].visible_content=[r].concat(u)}})),v(_,l.y,(function(t,n){var e=n.thread_uuid,r=n.content_uuid;t[e].realtime_content.includes(r)||t[e].realtime_content.push(r)})),v(_,l.ub,(function(t,n){var e=n.thread_uuid,r=n.content_uuid;if(!t[e].realtime_content.includes(r)){var u=t[e].realtime_content;t[e].realtime_content=[r].concat(u)}})),v(_,l.A,(function(t,n){var e=n.thread_uuid,r=n.limit,u=t[e],i=u.visible_content,o=u.realtime_content,c=o.slice(0,r);t[e].realtime_content=o.slice(r),t[e].visible_content=i.concat(c)})),v(_,l.wb,(function(t,n){var e=n.thread_uuid,r=n.limit,u=t[e],i=u.visible_content,o=u.realtime_content,c=o.slice(o.length-r,o.length);t[e].realtime_content=o.slice(0,o.length-r),t[e].visible_content=c.concat(i)})),v(_,l.dd,(function(t,n){var e=n.thread_uuid,r=n.is_in_view;t[e].is_in_view=r})),v(_,l.N,(function(t,n){t[n]&&(t[n].visible_content=[],t[n].page_from=null,t[n].more_available=!1)})),v(_,l.B,(function(t,n){var e=n.thread_uuid,r=n.contents,u=n.new_page,i=void 0===u||u,o=r.map((function(t){return t.content_uuid})).filter((function(n){return!t[e].visible_content.includes(n)}));t[e].visible_content=t[e].visible_content.concat(o),t[e].realtime_content=t[e].realtime_content.filter((function(t){return!o.includes(t)})),i&&o.length&&(t[e].page_from=o[o.length-1])})),v(_,l.xb,(function(t,n){var e=n.thread_uuid,r=n.contents.sort((function(t,n){return t.time-n.time})).map((function(t){return t.content_uuid})).filter((function(n){return!t[e].visible_content.includes(n)})),u=t[e].visible_content;t[e].visible_content=r.concat(u),t[e].realtime_content=t[e].realtime_content.filter((function(t){return!r.includes(t)})),t[e].page_from=r[0]})),v(_,l.d,(function(t,n){var e=n.thread_uuid,r=n.content_uuid;t[e].unread_mention_content.push(r)})),v(_,l.e,(function(t,n){var e=n.thread_uuid,r=n.content_uuid;t[e].unread_reply_content.push(r)})),v(_,l.Kb,(function(t,n){var e=n.thread_uuid,r=n.content_uuid,u=t[e].unread_mention_content.indexOf(r);t[e].unread_mention_content.splice(u,1)})),v(_,l.Lb,(function(t,n){var e=n.thread_uuid,r=n.content_uuid,u=t[e].unread_reply_content.indexOf(r);t[e].unread_reply_content.splice(u,1)})),v(_,l.jb,(function(t,n){t[n].total_content+=1})),v(_,l.Dc,(function(t,n){var e=n.thread_uuid,r=n.content_uuids;t[e].selected_content=t[e].selected_content.concat(r)})),v(_,l.L,(function(t,n){t[n].selected_content=t[n].selected_content.splice()})),v(_,l.Lc,(function(t,n){var e=n.thread_uuid,r=n.more_available;t[e].more_available=r})),_),p=(e(16),e(25),e(29),e(24),e(30),e(10),e(3)),g=e(133);function y(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function O(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,u,i=[],o=!0,c=!1;try{for(e=e.call(t);!(o=(r=e.next()).done)&&(i.push(r.value),!n||i.length!==n);o=!0);}catch(t){c=!0,u=t}finally{try{o||null==e.return||e.return()}finally{if(c)throw u}}return i}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return w(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return w(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var S=(y(h={},p.u,(function(t,n){for(var e=t.getters,r=t.commit,i=t.rootGetters,o=n.content_container_uuid,c=n.contents,a=n.more_available,_={},d=0;d<c.length;d++){var f=c[d];if(f.thread_uuid===o){_[f.content_uuid]=_[f.content_uuid]||{},_[f.content_uuid].visible_content=_[f.content_uuid].visible_content||[],_[f.content_uuid].thread_uuid=f.content_uuid,_[f.content_uuid].thread_top_uuid=f.thread_uuid,_[f.content_uuid].total_content=f.total_replies;var s=(0,i[u.dd])(f.content_uuid);_[f.content_uuid].unread_mention_content=s.map((function(t){return t.content_uuid}))}else{_[f.thread_uuid]||(_[f.thread_uuid]={},_[f.thread_uuid].visible_content=[]);var v=_[f.thread_uuid].visible_content;v.push(f),v.sort((function(t,n){return t.time-n.time})),_[f.thread_uuid].page_from=v[0].content_uuid}}for(var h in _)_[h].visible_content=_[h].visible_content.map((function(t){return t.content_uuid})),r(l.R,_[h]);if(!e[u.Sc](o)){var b=Object.keys(_),m=O(b,1)[0];r(l.R,{thread_uuid:o,visible_content:b,base_promo_uuid:m,page_from:b[b.length-1],more_available:a})}})),y(h,p.Sb,(function(t,n){var e=n.content_container_uuid,r=n.thread_uuid,i=n.selected_content_uuids,o=n.fetchAction,c=t.getters,a=t.commit,_=t.dispatch,d=t.rootGetters,f=c[u.Sc](r);return function(t,n,e,r,i){if(n)return Promise.resolve();var o=t.getters,c=t.commit,a=t.dispatch,_=t.rootGetters;return a(i,{content_container_uuid:e,content_uuids:r},{root:!0}).then((function(a){var d=_[u.S](a[0]),f=[];return d.thread_uuid===e&&(f=_[u.dd](r).map((function(t){return t.content_uuid}))),c(l.R,{thread_uuid:r,thread_top_uuid:d.thread_uuid,total_content:d.total_replies,unread_mention_content:f}),n=o[u.Sc](r),function(t,n,e,r){var i=t.getters,o=t.commit,c=t.dispatch,a=t.rootGetters,_=n===e.thread_top_uuid?e.thread_uuid:e.thread_top_uuid,d=a[u.S](_);if(d){if(!i[u.Sc](_)){var f=a[u.dd](_).map((function(t){return t.content_uuid})),s={thread_uuid:_,thread_top_uuid:n,total_content:d.total_replies,unread_mention_content:f};o(l.R,s)}return o(l.B,{thread_uuid:n,contents:[d],new_page:!1}),Promise.resolve()}return c(r,{content_container_uuid:n,content_uuids:_},{root:!0}).then((function(t){var e=a[u.S](t[0]),r=a[u.dd](_).map((function(t){return t.content_uuid})),i={thread_uuid:_,thread_top_uuid:n,total_content:e.total_replies,unread_mention_content:r};o(l.R,i),o(l.B,{thread_uuid:n,contents:[e],new_page:!1})}))}(t,e,n,i)}))}(t,f,e,r,o).then((function(){if(f||(f=c[u.Sc](r)),i){a(l.L,r);var t=i.filter((function(t){return!d[u.S](t)})).join();if(t.length>0)return _(o,{content_container_uuid:e,content_uuids:t},{root:!0}).then((function(){a(l.Dc,{thread_uuid:r,content_uuids:i})}));a(l.Dc,{thread_uuid:r,content_uuids:i})}return Promise.resolve()}))})),y(h,p.c,(function(t,n){var e=t.commit,r=t.getters,i=t.dispatch,o=t.rootGetters,c=n.content_container_uuid,a=n.parent_uuid,_=n.actor_uuid,d=n.parent_actor_uuid,f=n.thread_uuid,s=n.content_uuid,v=r[u.Sc](f);if(!v)return Promise.resolve();var h=f===c,b=o[u.a](c),m=b.thread_uuid===f||b.parent_thread_uuid===f;if(!o[u.Qb](s))return Promise.resolve();var y=v.realtime_content,O=v.visible_content,w=v.is_in_view,S=y.includes(s)||O.includes(s);if((h||m)&&S)return Promise.resolve();var j=function(t,n,e,r,i,o){var c=t[u.Y](e),a=0===r.length&&i;if(n)return!g.d||a||o?l.vb:l.ub;if(c||a)return l.z;return l.y}(o,h,s,y,w,0===O.length);return e(j,{thread_uuid:f,content_uuid:s}),m&&b.parent_thread_uuid!==c&&e(j,{thread_uuid:b.thread_uuid,content_uuid:s}),e(l.jb,f),i(p.d,{parent_actor_uuid:d,parent_uuid:a,actor_uuid:_,content_container_uuid:c,thread_uuid:f,content_uuid:s})})),y(h,p.d,(function(t,n){var e=t.rootGetters,r=t.commit,i=n.parent_actor_uuid,o=n.parent_uuid,c=n.actor_uuid,a=n.content_container_uuid,_=n.thread_uuid,d=n.content_uuid,f=e[u.kb];r(f===c||o===a||!(f===i)?l.e:l.d,{thread_uuid:_,content_uuid:d})})),y(h,p.Bc,(function(t,n){var e=t.getters,r=t.commit,i=t.rootGetters,o=n.thread_uuid,c=n.content_uuid,a=i[u.W](c),_=e[u.Sc](o);if(_){var d=!_.thread_top_uuid,f=a===_.thread_top_uuid,s={thread_uuid:d||f?o:_.thread_top_uuid,content_uuid:c},v=e[u.bc](s),h=e[u.cc](s);v&&r(l.Kb,s),h&&r(l.Lb,s)}})),h);e.d(n,"storeModule",(function(){return j}));var j=function(){return{namespaced:!0,state:function(){return{}},getters:d,actions:S,mutations:m}}}}]);
//# sourceMappingURL=threads-module-js.7cf87e6bdad4eb34a133.js.map